import re

ENCLOSING_REPLACEMENT_CHARACTER = '+'
ENCLOSED_REGEX = rf'\{ENCLOSING_REPLACEMENT_CHARACTER}([a-zA-Z_.0-9]*)\{ENCLOSING_REPLACEMENT_CHARACTER}'
OFFTOPIC_USERNAME = 'YUdsa1pHVn VJR1JsWTI5 a1pYST0‚ò†Ô∏èüè¥‚Äç'
ONTOPIC_USERNAME = 'YUdsa1pHVn VJR1JsWTI5 a1pYST0‚ò†Ô∏èüè¥‚Äç'
OFFTOPIC_CHAT_ID = '@' + OFFTOPIC_USERNAME
TELEGRAM_SUPERSCRIPT = '·µÄ·¥±·¥∏·¥±·¥≥·¥ø·¥¨·¥π'
FAQ_CHANNEL_ID = '@hackers_books'
SELF_BOT_NAME = 'GR_assistant_bot'
ONTOPIC_RULES = """ –£—Å–ª–æ–≤–∏—è –¥–µ–π—Å—Ç–≤–∏—è –ø—Ä–∞–≤–∏–ª —á–∞—Ç–∞

1.1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –∑–∞—Ö–æ–¥—è –≤ —á–∞—Ç, –ø—Ä–∏–Ω–∏–º–∞—é—Ç –Ω–∞ —Å–µ–±—è –¥–æ–±—Ä–æ–≤–æ–ª—å–Ω—ã–µ –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞ –±–µ—Å–ø—Ä–µ–∫–æ—Å–ª–æ–≤–Ω–æ —Å–æ–±–ª—é–¥–∞—Ç—å –Ω–∏–∂–µ–ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–Ω—ã–µ –ø—Ä–∞–≤–∏–ª.

1.2. –ù–µ–∑–Ω–∞–Ω–∏–µ –ø—Ä–∞–≤–∏–ª –Ω–µ –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç –æ—Ç –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –∑–∞ –∏—Ö –Ω–∞—Ä—É—à–µ–Ω–∏—è, —É–±–µ–¥–∏—Ç–µ–ª—å–Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º —Å –Ω–∏–º–∏ –æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è.

2. –í —á–∞—Ç–µ —Ä–∞–∑—Ä–µ—à–∞–µ—Ç—Å—è:

2.1. –û–±—â–∞—Ç—å—Å—è, –¥–µ–ª–∏—Ç—å—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –∏ –æ–±—Å—É–∂–¥–∞—Ç—å –ª—é–±—ã–µ —Ç–µ–º—ã, –∞ —Ç–∞–∫–∂–µ —Å–æ–≤–µ—Ä—à–∞—Ç—å –ª—é–±—ã–µ –¥—Ä—É–≥–∏–µ –¥–µ–π—Å—Ç–≤–∏—è –Ω–µ –Ω–∞—Ä—É—à–∞—é—â–∏–µ –ø.3

2.2. –í—Å—Ç—É–ø–∞—Ç—å –≤ –ª—é–±—ã–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è, –Ω–µ –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∞—â–∏–µ –∑–∞–∫–æ–Ω–æ–¥–∞—Ç–µ–ª—å—Å—Ç–≤—É –†–µ—Å–ø—É–±–ª–∏–∫–∏ –£–∑–±–µ–∫–∏—Å—Ç–∞–Ω.

2.3. –ü—Ä–µ–¥–ª–∞–≥–∞—Ç—å —É–ª—É—á—à–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã —á–∞—Ç–∞, –∂–∞–ª–æ–≤–∞—Ç—å—Å—è –Ω–∞ –ø–ª–æ—Ö—É—é —Ä–∞–±–æ—Ç—É —á–∞—Ç–∞.

3. –í —á–∞—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—á–µ—Å–∫–∏ –∑–∞–ø—Ä–µ—â–µ–Ω—ã:

3.1. –ú–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–æ –∏ –∑–∞–ø—Ä–µ—â–µ–Ω–Ω—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã.

3.1.1. –ú–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–æ. 

- —Å–æ–æ–±—â–µ–Ω–∏—è –æ –ª—é–±—ã—Ö —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö —Å–¥–µ–ª–∫–∞—Ö, –ø—Ä–æ–¥–∞–∂–∞—Ö, –æ–±–º–µ–Ω–µ, –¥–∞—Ä–µ–Ω–∏–∏, –ø–µ—Ä–µ–¥–∞—á–∏ –∞–∫–∫–∞—É–Ω—Ç–∞ –≤–æ –≤–ª–∞–¥–µ–Ω–∏—è –¥—Ä—É–≥–æ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞;

- —Å–æ–∑–¥–∞–Ω–∏–µ —Ñ–µ–π–∫–æ–≤;

- –∫–∞—Ç–µ–≥–æ—Ä–∏—á–µ—Å–∫–∏ –∑–∞–ø—Ä–µ—â–µ–Ω–æ –≤—ã–¥–∞–≤–∞—Ç—å —Å–µ–±—è –∑–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª—è –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞.

3.1.2. –ó–∞–ø—Ä–µ—â–µ–Ω–Ω—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã, —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ. 

- —Å–æ–æ–±—â–µ–Ω–∏—è, —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ –≤ —Å–µ–±–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ, —Å–ø—Ä–æ—Å –∏ –æ–±—Å—É–∂–¥–µ–Ω–∏–µ –∑–∞–ø—Ä–µ—â–µ–Ω–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º –≤ —á–∞—Ç–µ.

3.2. –ú–∞—Ç –∏ –∑–∞–≤—É–∞–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–∞—Ç.

–û—Ç–∫—Ä—ã—Ç—ã–π –º–∞—Ç (—Å–ª–æ–≤–∞, —Ñ—Ä–∞–∑—ã) –∏ –∑–∞–≤—É–∞–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–∞—Ç (—ç–≤—Ñ–µ–º–∏–∑–º—ã, –Ω–µ–¥–æ–ø–∏—Å–∞–Ω–Ω—ã–µ —Å–ª–æ–≤–∞, —Å–æ–∫—Ä–∞—â–µ–Ω–∏—è, —Å–ª–æ–≤–∞ —Å –∑–∞–º–µ–Ω–æ–π –æ–¥–Ω–æ–π –∏–ª–∏ –±–æ–ª–µ–µ –±—É–∫–≤, —Ç–∞–∫ –∏ —Å–ª–æ–≤–∞, —Å–æ –∑–≤–µ–∑–¥–æ—á–∫–∞–º–∏ –∏ —Ç.–ø.), –Ω–µ–Ω–æ—Ä–º–∞—Ç–∏–≤–Ω–∞—è –ª–µ–∫—Å–∏–∫–∞ –Ω–∞ –ª—é–±—ã—Ö —è–∑—ã–∫–∞—Ö, –≤ –ª—é–±–æ–π –∫–æ–¥–∏—Ä–æ–≤–∫–µ, –∞ —Ç–∞–∫ –∂–µ —Å–ª–æ–≤–∞ –æ—Å–∫–æ—Ä–±–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞ - –∑–∞–ø—Ä–µ—â–µ–Ω—ã –≤–æ –≤—Å–µ—Ö –∏—Ö –ø—Ä–æ—è–≤–ª–µ–Ω–∏—è—Ö!

3.2.1. –û—Ç–∫—Ä—ã—Ç—ã–π –º–∞—Ç.

3.2.2. –ó–∞–≤—É–∞–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–∞—Ç –∏ —Å–ª–æ–≤–∞ –æ—Å–∫–æ—Ä–±–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞ 

3.3. –î–∏—Å–∫—Ä–∏–º–∏–Ω–∞—Ü–∏—è –ø–æ —Ä–∞—Å–æ–≤–æ–º—É, –Ω–∞—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–º—É, —Ä–µ–ª–∏–≥–∏–æ–∑–Ω–æ–º—É –∏–ª–∏ –∏–Ω–æ–º—É –ø—Ä–∏–∑–Ω–∞–∫—É/–ù–∞—Ü–∏–æ–Ω–∞–ª–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ, —Ä–∞—Å–æ–≤—ã–µ –ª–æ–∑—É–Ω–≥–∏ –∏ –≤—ã—Å–∫–∞–∑—ã–≤–∞–Ω–∏—è.

3.3.1. –°–æ–æ–±—â–µ–Ω–∏—è, –ø—Ä–∏–∑—ã–≤–∞—é—â–∏–µ –∫ –∫–∞–∫–∏–º-–ª–∏–±–æ –¥–µ–π—Å—Ç–≤–∏—è–º –ø—Ä–æ—Ç–∏–≤ –¥—Ä—É–≥–∏—Ö –Ω–∞—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–µ–π.

3.3.2. –°–æ–æ–±—â–µ–Ω–∏—è, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –≥–æ–≤–æ—Ä–∏—Ç—Å—è –æ –ø—Ä–µ–≤–æ—Å—Ö–æ–¥—Å—Ç–≤–µ –æ–¥–Ω–æ–π –Ω–∞—Ü–∏–∏ –∏–ª–∏ –Ω–∞—Ä–æ–¥–∞ –Ω–∞–¥ –¥—Ä—É–≥–∏–º–∏.

3.3.3. –°–æ–æ–±—â–µ–Ω–∏—è, –≤–µ–¥—É—â–∏–µ –∫ –º–µ–∂–Ω–∞—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–π, —Ä–∞—Å–æ–≤–æ–π –Ω–µ–Ω–∞–≤–∏—Å—Ç–∏ –∏ —Ä–æ–∑–Ω–∏, –∞ —Ç–∞–∫–∂–µ –≤–µ–¥—É—â–∏–µ –∫ –ø—Ä–æ–≤–æ—Ü–∏—Ä–æ–≤–∞–Ω–∏—é –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –Ω–∞ —Ä–µ–ª–∏–≥–∏–æ–∑–Ω–æ–π –ø–æ—á–≤–µ.

3.3.4. –ü—Ä–æ–ø–∞–≥–∞–Ω–¥–∞ –Ω–µ—Ç–µ—Ä–ø–∏–º–æ—Å—Ç–∏ –∫ –∫–∞–∫–æ–π-–ª–∏–±–æ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏, –∞ —Ç–∞–∫–∂–µ –ø–æ–æ—â—Ä–µ–Ω–∏–µ –ø–æ–¥–æ–±–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π –∏ –≤—ã—Å–∫–∞–∑—ã–≤–∞–Ω–∏–π, —Å–æ–≤–µ—Ä—à–∞–µ–º—ã—Ö –¥—Ä—É–≥–∏–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏.

3.4. –ü—Ä–æ–ø–∞–≥–∞–Ω–¥–∞ –Ω–∞—Å–∏–ª–∏—è, –æ—Ä—É–∂–∏—è, –Ω–∞—Ä–∫–æ—Ç–∏–∫–æ–≤, –∞–ª–∫–æ–≥–æ–ª—è –∏ —Ç–∞–±–∞–∫–æ–∫—É—Ä–µ–Ω–∏—è –∏ —Ç.–¥.

- —Å–æ–æ–±—â–µ–Ω–∏—è, —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ –≤ —Å–µ–±–µ –ø—Ä–æ–ø–∞–≥–∞–Ω–¥—É –Ω–∞—Å–∏–ª–∏—è, –æ—Ä—É–∂–∏—è, —Ä–µ–∫–ª–∞–º—É –∏ –æ—Ç–∫—Ä—ã—Ç—ã–µ –æ–±—Å—É–∂–¥–µ–Ω–∏—è –ª—é–±—ã—Ö –Ω–∞—Ä–∫–æ—Ç–∏—á–µ—Å–∫–∏—Ö —Å—Ä–µ–¥—Å—Ç–≤, –∞ —Ç–∞–∫ –∂–µ –ø—Ä–æ–ø–∞–≥–∞–Ω–¥–∞ –∞–ª–∫–æ–≥–æ–ª—å–Ω—ã—Ö –Ω–∞–ø–∏—Ç–∫–æ–≤ –∏ —Ç–∞–±–∞—á–Ω—ã—Ö –∏–∑–¥–µ–ª–∏–π, —Å–æ–æ–±—â–µ–Ω–∏—è —Å–µ–∫—Å—É–∞–ª—å–Ω–æ-–ø–æ—Ä–Ω–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–≥–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞, –≤ —Ç–æ–º —á–∏—Å–ª–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —Å–º–∞–π–ª—ã –∞–Ω–∞—Ç–æ–º–∏—á–µ—Å–∫–æ–≥–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞ –≤ —á–∞—Ç–µ –∑–∞–ø—Ä–µ—â–µ–Ω—ã.

3.5. –ö–ª–µ–≤–µ—Ç–∞, –≥–æ–ª–æ—Å–ª–æ–≤–Ω—ã–µ –æ–±–≤–∏–Ω–µ–Ω–∏—è (–±–µ–∑–¥–æ–∫–∞–∑–∞—Ç–µ–ª—å–Ω—ã–µ)/–†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ª–æ–∂–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.

- —Å–æ–æ–±—â–µ–Ω–∏—è –æ–±–≤–∏–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞

- —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –∑–∞–≤–µ–¥–æ–º–æ –ª–æ–∂–Ω–æ–π –∏–ª–∏ –Ω–µ–ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.

3.6. –ó–∞–ø—Ä–µ—â–∞–µ—Ç—Å—è –ø—Ä—è–º–æ –∏ –∫–æ—Å–≤–µ–Ω–Ω–æ –æ—Å–∫–æ—Ä–±–ª—è—Ç—å –¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ —á–∞—Ç–µ (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã—Ö —Ä–∞–∑–≥–æ–≤–æ—Ä–Ω—ã—Ö —Å–ª–æ–≤ –ø—Ä–∏ –æ—Å–∫–æ—Ä–±–ª–µ–Ω–∏–∏ –∏–ª–∏ —Ö–∞–º—Å—Ç–≤–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —á–∞—Ç–∞), —Ö–∞–º–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏–∏ —á–∞—Ç–∞, —É—Å—Ç—Ä–∞–∏–≤–∞—Ç—å —Ä–∞–∑–±–æ—Ä–∫–∏/–≤—ã—è—Å–Ω–µ–Ω–∏—è –æ—Ç–Ω–æ—à–µ–Ω–∏–π.

3.7. –°–ø–∞–º, —Ñ–ª—É–¥, —Ä–µ–∫–ª–∞–º–∞.

3.7.1. –§–ª—É–¥

- –æ—Ç–ø—Ä–∞–≤–∫–∞ –±–æ–ª—å—à–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –æ–¥–Ω–æ—Ç–∏–ø–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —Ç–µ—á–µ–Ω–∏–µ 3 –º–∏–Ω—É—Ç;

- –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–æ–ª–µ–µ 3 (—Ç—Ä–µ—Ö) –ª—é–±—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤ –∏–ª–∏ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –±—É–∫–≤, –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ –±–æ–ª–µ–µ 3 (—Ç—Ä–µ—Ö) –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö —Å–ª–æ–≤ –ø–æ–¥—Ä—è–¥ –≤ –æ–¥–Ω–æ–º —Å–æ–æ–±—â–µ–Ω–∏–∏;

- –æ—Ç–ø—Ä–∞–≤–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å –æ–±—ä–µ–¥–∏–Ω–µ–Ω—ã –≤ –æ–¥–Ω–æ, –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã—Ö –ø–æ –æ–¥–Ω–æ–º—É —Å–ª–æ–≤—É –∏–ª–∏ –ø–æ –æ–¥–Ω–æ–π –±—É–∫–≤–µ.

3.7.2. –°–ø–∞–º/ –†–µ–∫–ª–∞–º–∞/–°—Å—ã–ª–∫–∏: 

- –∫–æ–º–º–µ—Ä—á–µ—Å–∫–∞—è –∏ –Ω–µ–∫–æ–º–º–µ—Ä—á–µ—Å–∫–∞—è —Ä–µ–∫–ª–∞–º–∞, –∞ —Ç–∞–∫–∂–µ –æ–±—Å—É–∂–¥–µ–Ω–∏–µ —Å–∞–π—Ç–æ–≤, —Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ –Ω–µ –æ—Ç–Ω–æ—Å—è—â–∏—Ö—Å—è –∫ –ø—Ä–æ–µ–∫—Ç–∞–º –∫–æ–º–ø–∞–Ω–∏–∏ 

- –æ–±—ä—è–≤–ª–µ–Ω–∏—è —á–∞—Å—Ç–Ω–æ–≥–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞, —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –Ω–∞ –ø–æ–∫—É–ø–∫—É\–ø—Ä–æ–¥–∞–∂—É —Ç–∏—Ç—É–ª—å–Ω—ã—Ö –∑–Ω–∞–∫–æ–≤, –≤ —Ç–æ–º —á–∏—Å–ª–µ —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ –∫–æ–Ω—Ç–∞–∫—Ç–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é.

3.7.3. –¢—Ä–æ–ª–ª–∏–Ω–≥, —Ñ–ª–µ–π–º, —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ª–∏—á–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.

–¢—Ä–æ–ª–ª–∏–Ω–≥ - —Å–æ–æ–±—â–µ–Ω–∏—è –ø—Ä–æ–≤–æ–∫–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞, –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã–µ —Å —Ü–µ–ª—å—é –≤—ã–∑–≤–∞—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã, —Å–ø–æ—Ä—ã, –≤–∑–∞–∏–º–Ω—ã–µ –æ—Å–∫–æ—Ä–±–ª–µ–Ω–∏—è.

–¢—Ä–æ–ª–ª–∏–Ω–≥/–æ–±—Å—É–∂–¥–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–æ–≤: 

- –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã –ú–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞–º, –∑–∞–¥–∞–≤–∞–µ–º—ã–µ –∑–∞ –Ω–µ–±–æ–ª—å—à–æ–π –ø–µ—Ä–∏–æ–¥ –≤—Ä–µ–º–µ–Ω–∏, —Å —Ü–µ–ª—å—é –∑–∞—Ç—Ä—É–¥–Ω–∏—Ç—å —Ä–∞–±–æ—Ç—É –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–æ–≤; 

- —Å–æ–æ–±—â–µ–Ω–∏—è, —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ –≤ —Å–µ–±–µ –æ–±—Å—É–∂–¥–µ–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏–π –ú–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞ –∏/–∏–ª–∏ –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞ –∏–ª–∏ –Ω–µ—Å–æ–≥–ª–∞—Å–∏–µ —Å –Ω–∏–º–∏.

–°–ø–∞–º ‚Äì —Ä–µ–∫–ª–∞–º–∞ –∫–∞–∫–æ–≥–æ –ª–∏–±–æ —Ä–µ—Å—É—Ä—Å–∞ –≤ —è–≤–Ω–æ–π —Ñ–æ—Ä–º–µ.

3.8. –†–∞–∑–≥–ª–∞—à–µ–Ω–∏–µ –ª–∏—á–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏: 

- —Å–æ–æ–±—â–µ–Ω–∏—è, —Ä–∞–∑–≥–ª–∞—à–∞—é—â–∏–µ –ª—é–±—É—é –ª–∏—á–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é —É—á–∞—Å—Ç–Ω–∏–∫–∞, –ú–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞, –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞ –±–µ–∑ –µ–≥–æ —Å–æ–≥–ª–∞—Å–∏—è.

3.9. –£–≥—Ä–æ–∑—ã –∏ –æ—Å–∫–æ—Ä–±–ª–µ–Ω–∏—è.

3.9.1. –£–≥—Ä–æ–∑—ã: 

- —Å–æ–æ–±—â–µ–Ω–∏—è, —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ –≤ —Å–µ–±–µ –ø—Ä—è–º—ã–µ –∏–ª–∏ –∫–æ—Å–≤–µ–Ω–Ω—ã–µ —É–≥—Ä–æ–∑—ã —Ä–∞—Å–ø—Ä–∞–≤—ã –≤ —Ä–µ–∞–ª—å–Ω–æ–π –∂–∏–∑–Ω–∏, –≤—ã–º–æ–≥–∞—Ç–µ–ª—å—Å—Ç–≤–æ –∏ —à–∞–Ω—Ç–∞–∂.

3.9.2. –û—Å–∫–æ—Ä–±–ª–µ–Ω–∏—è: 

- –æ—Å–∫–æ—Ä–±–ª–µ–Ω–∏–µ –≤ –ª—é–±–æ–π —Ñ–æ—Ä–º–µ, —É–Ω–∏–∂–µ–Ω–∏–µ —á–µ–ª–æ–≤–µ—á–µ—Å–∫–æ–≥–æ –¥–æ—Å—Ç–æ–∏–Ω—Å—Ç–≤–∞ –∏ —Å–ª–æ–≤–∞

3.9.3. –û—Å–∫–æ—Ä–±–ª–µ–Ω–∏–µ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞: 

- –æ—Å–∫–æ—Ä–±–ª–µ–Ω–∏–µ –ú–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞, –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª–µ–π –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏–ª–∏ –∫–æ–º–ø–∞–Ω–∏–∏ 

- —É–≥—Ä–æ–∑—ã —Ä–∞—Å–ø—Ä–∞–≤—ã –∏–ª–∏ —É–≥—Ä–æ–∑—ã —Å–Ω—è—Ç–∏—è —Å –º–æ–¥–µ—Ä–∞—Ç–æ—Ä—Å–∫–æ–≥–æ –ø–æ—Å—Ç–∞.

3.10. –ó–∞–Ω–∏–º–∞—Ç—å—Å—è –ø–æ–ø—Ä–æ—à–∞–π–Ω–∏—á–µ—Å—Ç–≤–æ–º.

3.11. –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å –∫–∞–∫–∏–µ-–ª–∏–±–æ —Å–æ–æ–±—â–µ–Ω–∏—è –∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏, —Ä–∞–∑–º–µ—â–∞—Ç—å –∫–∞—Ä—Ç–∏–Ω–∫–∏/—Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∏–∫–∏, –æ—Å–∫–æ—Ä–±–ª—è—é—â–∏–µ –æ–±—â–µ–ø—Ä–∏–Ω—è—Ç—ã–µ –Ω–æ—Ä–º—ã –Ω—Ä–∞–≤—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏.

4. –í —á–∞—Ç–µ –Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è

4.1. –ó–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª—è—Ç—å ¬´Caps Lock¬ª–æ–º. 

4.2. –ó–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª—è—Ç—å —Å–º–∞–π–ª–∞–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å 5 –∏–ª–∏ –±–æ–ª–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–π –ø–æ–¥—Ä—è–¥, —Å–æ–¥–µ—Ä–∂–∞—â–∏—Ö —Ç–æ–ª—å–∫–æ —Å–º–∞–π–ª—ã).

4.3. –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å –æ–±—ä–µ–º–Ω—ã–µ —Ü–∏—Ç–∞—Ç—ã, –≤ —Ç–æ–º —á–∏—Å–ª–µ –ø–æ—Ä–µ–∑–∞–Ω–Ω—ã–µ –Ω–∞ —á–∞—Å—Ç–∏ –≤ –æ—Å–Ω–æ–≤–Ω–æ–π —á–∞—Ç. –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –í—ã –º–æ–∂–µ—Ç–µ —É–∫–∞–∑–∞—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ –∏—Å—Ç–æ—á–Ω–∏–∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.

4.5. –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –ø—Ä–æ—Å—å–±—ã –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–æ–≤ —á–∞—Ç–∞.

5. –ü—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞.

5.1. –ï—Å–ª–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –∏–ª–∏ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä —Å—á–∏—Ç–∞–µ—Ç, —á—Ç–æ –∫–∞–∫–æ–µ-–ª–∏–±–æ –¥–µ–π—Å—Ç–≤–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –º–µ—à–∞–µ—Ç –æ—Å—Ç–∞–ª—å–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º, –æ–Ω –æ–±—è–∑–∞–Ω –ø—Ä–µ–¥—É–ø—Ä–µ–¥–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º–æ—Å—Ç–∏ —Ç–∞–∫–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è.

5.2. –í —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –ø—Ä–∏—Å–ª—É—à–∞–ª—Å—è –∫ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏, –æ–Ω –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –Ω–∞ –ª—é–±–æ–π —Å—Ä–æ–∫, –∫–æ—Ç–æ—Ä—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –ø–æ—Å—á–∏—Ç–∞—é—Ç —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤—ã–º. 

5.3. –í —Å–ª—É—á–∞–µ –≤—ã—è–≤–ª–µ–Ω–∏—è —Ñ–ª—É–¥–∞ –∏–ª–∏ —Å–ø–∞–º–∞, –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã —á–∞—Ç–∞ –∏–º–µ—é—Ç –ø—Ä–∞–≤–æ —É–¥–∞–ª–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ —á–∞—Ç–∞."""
OFFTOPIC_RULES = """
–î–µ–ª–∞–π—Ç–µ –≤—Å–µ —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ"""

# Github username
# Per https://github.com/join
# Github username may only contain alphanumeric characters or hyphens.
# Github username cannot have multiple consecutive hyphens.
# Github username cannot begin or end with a hyphen.
# Maximum is 39 characters.
# Therefore we use:
# [a-z\d](?:[a-z\d]|-(?=[a-z\d])){0,38}

# Repo names seem to allow alphanumeric, -, . and _
# And the form at https://github.com/new has a maxlength of 100
# Therefore we use
# [A-Za-z0-9-._]{0,100}

GITHUB_PATTERN = re.compile(r'''
    (?i)                                # Case insensitivity
    [\s\S]*?                            # Any characters
    (?P<full>                           # Capture for the the whole thing
        (?:                                 # Optional non-capture group for username/repo
            (?:(?P<owner>[a-z\d](?:[a-z\d]|-(?=[a-z\d])){0,38})/)?  # Matches username or org - only if ends with slash
            (?P<repo>[A-Za-z0-9-._]{0,100})?           # Optionally matches repo
        )?                                  # End optional non-capture group
        (?:                                 # Match either
            (
                (?P<number_type>\#|GH-|PR-)     # Hashtag or "GH-" or "PR-"
                (?:                             # Followed by either
                    (?P<number>\d+)                 # Numbers
                    |                           # Or
                    (?P<query>\S+)                  # A search query (without spaces) (only works inline)
                )
            )
        |                                   # Or
            (?:@?(?P<sha>[0-9a-f]{40}))         # at sign followed by 40 hexadecimal characters
        )
    )
''', re.VERBOSE)

